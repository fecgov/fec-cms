{% load static compress wagtailuserbar %}
{% load filters %}
<!DOCTYPE html>
<html lang="en">
  <head>
    {% include 'partials/meta-tags.html' %}
    {% if settings.FEC_CMS_ENVIRONMENT == 'PRODUCTION' %}
    {% include 'partials/meta-tags-preconnects.html' %}
    {% endif %}

    <title>{% block title %}{% if self.seo_title %}{{ self.seo_title }}{% else %}{{ self.title }} | FEC {% endif %}{% endblock %}{% block title_suffix %}{% endblock %}</title>

    {% include 'partials/google-tag-manager-script.html' %}

    {% block css %}
    <link rel="stylesheet" type="text/css" href="{% asset_for_css 'base.css' %}">
    {% endblock %}
    <script crossorigin="anonymous" src="https://polyfill.io/v3/polyfill.min.js?flags=gated&features=Object.assign"></script>

    <script>
      BASE_PATH = '/';
      FEC_APP_URL = '{{ settings.FEC_APP_URL }}';
      API_LOCATION = '{{ settings.FEC_API_URL }}';
      API_VERSION = '{{ settings.FEC_API_VERSION }}';
      API_KEY_PUBLIC = '{{ settings.FEC_API_KEY_PUBLIC }}';
      API_KEY_PUBLIC_CALENDAR = '{{ settings.FEC_API_KEY_PUBLIC_CALENDAR }}';
      CANONICAL_BASE = '{{ settings.CANONICAL_BASE }}';

      useTt = {% if settings.FEATURES.use_tt == False %}false{% else %}true{% endif %};
      {# TODO: remove useTt with the use_tt feature flag #}
    </script>
  </head>

  <body class="{% block body_class %}{% endblock %}">
    <div id="ie_warning" style="display: none;">
      <h2>Your web browser is not supported</h2>
      <p>You&apos;re using Internet Explorer, some features might not work. Please switch to another browser like Chrome, Firefox, or Edge for a better experience.</p>
    </div>

    {% include 'partials/google-tag-manager-noscript.html' %}

    {% wagtailuserbar %}
    <a href="#main" class="skip-nav">skip navigation</a>
    {# env-specific banner #} 
    {% include 'partials/env-banner.html' %}
    {# .gov banner #}
    {% include 'partials/usa-banner.html' %}
    {% if self.title == "Homepage" or self.title == "Home" %}
    <header class="site-header site-header--homepage">
      <div class="masthead">
        <div class="homepage-seal">
          <img src="{% static 'img/seal.svg' %}" alt="FEC logo" width="160" height="160">
        </div>
        <div class="site-title--print"></div>
        <a title="Home" href="/" class="site-title" rel="home"><span class="u-visually-hidden">Federal Election Commission | United States of America</span></a>
        <ul class="utility-nav list--flat">
          <li class="utility-nav__item"><a href="/calendar/">Calendar</a></li>
          <li class="utility-nav__item">
            <a class="js-glossary-toggle glossary__toggle">Glossary</a>
          </li>
          <li class="utility-nav__search">
            <form accept-charset="UTF-8" action="/search" class="combo" method="get" role="search">
              <input type="hidden" name="type" value="candidates">
              <input type="hidden" name="type" value="committees">
              <input type="hidden" name="type" value="site">
              <label class="u-visually-hidden" for="query">Search</label>
              <div class="combo combo--search">
                <input
                  class="js-site-search combo__input"
                  id="query"
                  name="query"
                  type="text"
                  data-dataset="all"
                  data-search-type="all"
                  aria-autocomplete="list"
                  aria-controls="query_listbox"
                  aria-expanded="false"
                  aria-label="Search FEC.gov"
                  {% if settings.FEATURES.use_tt == False %}data-{% endif %}autocomplete="off">
                <button type="submit" class="button--standard combo__button button--search">
                  <span class="u-visually-hidden">Search</span>
                </button>
              </div>
            </form>
          </li>
        </ul>
      </div>
      {% include 'partials/navigation/navigation.html' %}
    </header>
    {% else %}
    <header class="site-header">
      <div class="masthead">
        <div class="site-title--print"></div>
        <a title="Home" href="/" class="site-title" rel="home"><span class="u-visually-hidden">Federal Election Commission | United States of America</span></a>
        <ul class="utility-nav list--flat">
          <li class="utility-nav__item{% if self.content_section == 'calendar' %} is-active{% endif %}"><a href="/calendar/">Calendar</a></li>
           <li class="utility-nav__item"><a class="js-glossary-toggle glossary__toggle">Glossary</a></li>
          <li class="utility-nav__search">
            <form accept-charset="UTF-8" action="/search" id="search_form" class="combo" method="get" role="search">
              <input type="hidden" name="type" value="candidates">
              <input type="hidden" name="type" value="committees">
              <input type="hidden" name="type" value="site">
              <label class="u-visually-hidden" for="query">Search</label>
              <div class="combo combo--search">
                <input
                  class="js-site-search combo__input"
                  id="query"
                  name="query"
                  type="text"
                  data-search-type="all"
                  aria-autocomplete="list"
                  aria-controls="query_listbox"
                  aria-expanded="false"
                  aria-label="Search FEC.gov"
                  {% if settings.FEATURES.use_tt == False %}data-{% endif %}autocomplete="off"
                >
                <button type="submit" class="button--standard combo__button button--search">
                  <span class="u-visually-hidden">Search</span>
                </button>
              </div>
            </form>
          </li>
        </ul>
      </div>
      {% include 'partials/navigation/navigation.html' %}
    </header>
    {% endif %}

    <main id="main">
      {% block content %}{% endblock %}
    </main>

    {% include 'partials/footer-navigation.html' %}
    <footer class="footer">
      <div class="container">
        <div class="seal">
          <img class="seal__img" width="140" height="140" src="{% static "img/seal--inverse.svg" %}" alt="Seal of the Federal Election Commission | United States of America">
          <p class="address__title">Federal Election Commission</p>
        </div>

        <div class="address">
          <ul class="social-media">
            <li>
              <div class="i icon--twitter">
                <a href="https://twitter.com/fec"><span class="u-visually-hidden">The FEC's Twitter page</span></a>
              </div>
            </li>
            <li>
              <div class="i icon--youtube">
                <a href="https://www.youtube.com/user/FECTube"><span class="u-visually-hidden">The FEC's YouTube page</span></a>
              </div>
            </li>
          </ul>

          <p>1050 First Street, NE<br>
          Washington, DC 20463</p>

          <a href="https://public.govdelivery.com/accounts/USFEC/subscriber/topics?qsp=CODE_RED" target="_blank" rel="noopener">
            <button class="button--standard button--envelope">Sign up for FECMail</button>
          </a>
        </div>
      </div>
    </footer>

    {% include './partials/glossary.html' %}

    {% csrf_token %}

    {# Global javascript #}
    <script type="text/javascript" src="{% asset_for_js 'vendor.js' %}"></script>
    <script type="text/javascript" src="{% asset_for_js 'init.js' %}"></script>
    <script>
      var canSkipPolyfills = ('fetch' in window && 'assign' in Object);
      if (!canSkipPolyfills) {
        var pfScriptElem = document.createElement('script');
        pfScriptElem.async = false;
        pfScriptElem.src = "{% asset_for_js 'polyfills.js' %}";
        document.head.appendChild(pfScriptElem);
      }
    </script>
    <script>
      var calcAdminFineJsPath = '{% asset_for_js "calc-admin-fines.js" %}';
    </script>
    <script type="text/javascript" src="{% asset_for_js 'calc-admin-fines-modal.js' %}"></script>

    {% block extra_js %}
    {# Override this in templates to add extra javascript #}
    {% endblock %}

    {# GSA DAP for Production #}
    {% if settings.FEC_CMS_ENVIRONMENT == 'PRODUCTION' %}
    <script id="_fed_an_ua_tag" src="https://dap.digitalgov.gov/Universal-Federated-Analytics-Min.js?agency=FEC"></script>
    {% endif %}
  </body>
</html>
