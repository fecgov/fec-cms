{% macro select_json(name, label, keys, options={}, default=none, show_tooltip_text='') %}
<div class="filter js-filter js-filter-control" data-filter="select"
data-validate="false" data-modifies-filter="{{ name }}" data-required-default="{{ default }}">
  <label for="{{ name }}" class="label t-inline-block">{{ label }}</label>
  {% if show_tooltip_text != '' %}
  <div class="tooltip__container u-margin--bottom">
    <button class="tooltip__trigger"><span class="u-visually-hidden">Learn more</span></button>
    <div class="tooltip tooltip--left tooltip--above">
      <p class="tooltip__content tooltip__content">{{ show_tooltip_text }}</p>
    </div>
  </div>
  {% endif %}
  <select id="{{ name }}" name="{{ name }}">
    {% for key,value in options.items() %}
      <option value="{{ key }}">{{ value }}</option>
    {% endfor %}
  </select>
</div>
{% endmacro %}

{% macro select_json_indentation(name, label, keys, options={}, default=none, data_prefix='') %}
<div class="filter js-filter js-filter-control sub--filter--indent" data-filter="select" 
data-validate="false" data-name="{{ name }}" data-modifies-filter="{{ name }}" data-required-default="{{ default }}">
  <label for="{{ name }}" class="label">{{ label }}</label>
  <select id="{{ name }}" name="{{ name }}" data-filter-change="true" data-removeable-filter="true" data-prefix="{{ data_prefix }}">
    {% for key,value in options.items() %}
      <option value="{{ key }}">{{ value }}</option>
    {% endfor %}
  </select>
</div>
{% endmacro %}

{#
  @param {string} name - Used in <label for="{name}"><input id="{name}" name="{name}"
  @param {string} label - Used in <label>{label}</label> and <label>Limit 1 {label}</label>
  @param {list} options[] - The data used for <optgroup label="{}">
  @param {list} options[][] - The data used for <optgroup><option value="{}" data-line-type="{}">{}</option>
  @param {*} [default=none] - unused
  @param {*} [selected={}] - unused
  @param {string} [title_prefix=''] - Used in <optgroup label="{title_prefix} …">
  @param {list} [forms=[]] - Used in <optgroup label="… {forms[loop.index-1]}"></optgroup>
#}
{% macro select_single(name, label, options={}, default=none, selected={}, title_prefix='', forms=[]) %}
<div class="filter js-filter js-filter-control" data-filter="select" data-name="{{ name }}" data-validate="false" data-modifies-filter="{{ name }}">
  <label for="{{ name }}" class="label">{{ label }}</label>
  <label class="label--help u-margin--top">Limit 1 {{ label | lower }}</label>
  <select id="{{ name }}" name="{{ name }}" data-filter-change="true" data-removeable-filter="true">
    <option value=''>More</option>
    {% for title, val in options.items() %}
    <optgroup label="{{ title_prefix }} {{ title }} {%if forms %}({{ forms[loop.index-1] }}){% endif %}">
       {% for value, label in val.items() %}
          <option value={{value}} data-line-type="{{ title }}">{{ label }}</option>
      {% endfor %}
    {% endfor %}
    </optgroup>
  </select>
</div>
{% endmacro %}

{#
  @param {string} name - Used in <label for="{name}"><input id="{name}" name="{name}"
  @param {string} label - Used in <label>{label}</label> and <label>Limit 1 {label}</label>
  @param {list} options[] - The data used for <option value="{}">{}</option>
#}
{% macro select_single_flat_list(name, label, options={}, hide_help=false, first_opt_no_value_label=false, data_prefix='') %}
<div class="filter js-filter js-filter-control" id="{{ name }}-field" data-filter="select" data-name="{{ name }}" data-validate="false" data-modifies-filter="{{ name }}">
  <label for="{{ name }}" class="label">{{ label }}</label>
  {% if not hide_help -%}
  <label class="label--help u-margin--top">Limit 1 {{ label | lower }}</label>
  {%- endif %}
  <select id="{{ name }}" name="{{ name }}" data-filter-change="true" data-removeable-filter="true" class="dropdown" data-prefix="{{ data_prefix }}">
    {% if first_opt_no_value_label %}<option value=''>{{ first_opt_no_value_label }}</option>{% endif %}
    {% for itemValue, itemLabel in options.items() %}
      <option value={{itemValue}}>{{ itemLabel }}</option>
    {% endfor %}
    </optgroup>
  </select>
</div>
{% endmacro %}


{# -----------NEW-------------------- #}

{#  WORKS (rename this from range to something else and try to make it more reusable) #}
{% macro select_single_flat_list_range(name, label, options={}, hide_help=false, first_opt_no_value_label=false) %}
<div class="filter js-filter js-filter-control" id="{{ name }}-field" data-filter="select"  data-validate="false" data-name="{{ name }}">
 <fieldset class="filter" id="{{name}}-field">
    <div class="range range--date js-date-range js-filter" data-modifies-filter="primary_{{ name }}" data_prefix="Primary subject" data-name="primary_{{ name }}" data-filter="range">
    <label for="{{ name }}" class="label">{{ label }}</label>
    {% if not hide_help -%}
    <label class="label--help u-margin--top">Limit 1 {{ label | lower }}</label>
    {%- endif %}
    <select id="primary_{{ name }}" name="primary_{{ name }}" data-range="min" data-filter-change="true" data-removeable-filter="true" class="dropdown" data-prefix="Primary subject: "  data-removable="true" class="js-min-date">
      {% if first_opt_no_value_label %}<option value=''>{{ first_opt_no_value_label }}</option>{% endif %}
      {% for itemValue, itemLabel in options.items() %}
        <option value={{itemValue}}>{{ itemLabel }}</option>
      {% endfor %}
    </select>
    </div>

    <div class="range range--date js-date-range filter js-filter sub--filter--indent" data-modifies-filter="secondary_{{ name }}" data_prefix="Secondary subject: " data-name="secondary_{{ name }}" data-filter="range">
    <label for="{{ name }}" class="label">Secondary {{ label }}</label>
    {% if not hide_help -%}
    <label class="label--help u-margin--top">Limit 1 {{ label | lower }}</label>
    {%- endif %}
    <select id="secondary_{{ name }}" name="secondary_{{ name }}" data-range="max" data-filter-change="true" data-removeable-filter="true" class="dropdown" data-prefix="Secondary subject: " data-removable="true" class="js-max-date">
      {% if first_opt_no_value_label %}<option value=''>{{ first_opt_no_value_label }}</option>{% endif %}
      {% for itemValue, itemLabel in options.items() %}
        <option value={{itemValue}}>{{ itemLabel }}</option>
      {% endfor %}
    </select>
    </div>
  </fieldset>
</div> 
{% endmacro %}
{#  END BEST #}


{% macro select_single_flat_list_subject(name, label, options={}, hide_help=false, first_opt_no_value_label=false) %}
<div class="filter js-filter js-filter-control" id="{{ name }}-field" data-filter="select"  data-validate="false">
 <fieldset>
    <div data-modifies-filter="primary_{{ name }}" data_prefix="Primary subject" data-name="primary_{{ name }}">
    <label for="{{ name }}" class="label">{{ label }}</label>
    {% if not hide_help -%}
    <label class="label--help u-margin--top">Limit 1 {{ label | lower }}</label>
    {%- endif %}
    <select id="primary_{{ name }}" name="primary_{{ name }}" data-filter-change="true" data-removeable-filter="true" class="dropdown" data-prefix="Primary subject: "  data-removable="true">
      {% if first_opt_no_value_label %}<option value=''>{{ first_opt_no_value_label }}</option>{% endif %}
      {% for itemValue, itemLabel in options.items() %}
        <option value={{itemValue}}>{{ itemLabel }}</option>
      {% endfor %}
    </select>
    </div>

    <div class="sub--filter--indent" data-modifies-filter="secondary_{{ name }}" data_prefix="Secondary subject: " data-name="secondary_{{ name }}">
    <label for="{{ name }}" class="label">{{ label }}</label>
    {% if not hide_help -%}
    <label class="label--help u-margin--top">Limit 1 {{ label | lower }}</label>
    {%- endif %}
    <select id="secondary_{{ name }}" name="secondary_{{ name }}" data-filter-change="true" data-removeable-filter="true" class="dropdown" data-prefix="Secondary subject: " data-removable="true">
      {% if first_opt_no_value_label %}<option value=''>{{ first_opt_no_value_label }}</option>{% endif %}
      {% for itemValue, itemLabel in options.items() %}
        <option value={{itemValue}}>{{ itemLabel }}</option>
      {% endfor %}
    </select>
    </div>
  </fieldset>
</div>
{% endmacro %}

{# ----------/END-NEW-------------------- #}
